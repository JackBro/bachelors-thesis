\subsubsection{Blocking DLL Injections by hooking \syscall{LoadLibrary}}
For the \gls{DLL} injections based attacks of node [1.2] of Figure \ref{fig:attacks_external}, \gls{ACL} as explained in Sections \ref{sec:sd} and \ref{sec:dacl} can not be used, as it is unknown which \glspl{DLL} are malicious. For which \gls{DLL} files an \gls{ACE} should be set to prevent execution. Additionally, the user of a file has always full permissions to change the \gls{ACE}, so that any permission restriction can be easily undone. Thus, the \gls{ACL} turns out to be useless and doesn't prevent loading of \glspl{DLL} in all cases. 

Therefore a better approach is, hooking the \syscall{LoadLibrary} function, by detouring the function call, as shown in Figure \ref{fig:detours}. The application will then get called every time a \gls{DLL} is loaded and can return early with a \syscall{STATUS\_ACCCESS\_DENIED} error code, if the to be loaded \gls{DLL} is unwanted. However, this function might not be called in all \gls{DLL} load cases, as the hook is placed after the process has started running. As a local hook is not enough to detect \gls{DLL} loads before the hook is installed, a deeper system hook is needed. Unfortunately, this requires patching the system call table and is prevented on 64 bit systems due to PatchGuard since Windows 7. Therefore, a different approach needs to be taken to catch all cases.