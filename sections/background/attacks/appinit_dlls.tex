\subsubsection{\emph{Registry} Based Injection}
\emph{Registry} based injection uses a special \emph{Registry} key\footnote{The \emph{Registry} key can be found at \syscall{HKEY\_LOCAL\_MACHINE\textbackslash Software\textbackslash Microsoft\textbackslash\allowbreak Windows NT\textbackslash CurrentVersion\textbackslash Windows}} that can be used to inject \gls{DLL} files into almost any process. For that reason the shown attack tree in Figure~\ref{fig:attacks_external} lists this technique under the group of \gls{DLL} injections in node [1.2.1]. \glspl{DLL} can be added by writing the full path to the file into this \emph{Registry} key, with multiple paths separated by semicolons. To make this injection technique work, two conditions have to apply:
\begin{enumerate}
\item The \gls{DLL} file is having a security descriptor that allows execution. Otherwise the \gls{DLL} will not get loaded into the target process.
\item The \gls{MSDN} \cite{msdn_appinitdlls} lists the usage of \syscall{User32\allowbreak.dll} in the target process as a requirement or otherwise the \glspl{DLL} listed in the \emph{Registry} will not get loaded.
\end{enumerate}
However, these two conditions are easy to fulfill. The first condition is by default true, because the default security descriptor of \gls{DLL} files allow execution. Active interaction by other programs or the user is required to change the security descriptor. The second condition is most of the time fulfilled. \syscall{User32.dll} is used in almost every process and in general it can be assumed that the \gls{MSDN} requirement is fulfilled. To make this attack work, a second \emph{Registry} key, \syscall{LoadAppInit\_DLLs}, has to be changed to value 1, in order to activate this \emph{Registry} based injection. By default this value is set to 0 and cannot be changed without admin privileges.
Defending against this kind of attack is comparably easy, by checking \syscall{AppInit\_DLLs} value and enumerating all loaded modules (\glspl{DLL}). If a match is found and considered to be unwanted, it can be unloaded or as a safety measurement the application is terminated. As for \emph{Google Chrome}, there is no validation currently in place and \emph{Registry} based injection can be used to load arbitrary \gls{DLL} files.