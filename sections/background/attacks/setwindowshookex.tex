\subsubsection{\syscall{SetWindowsHookEx} injection}
A stronger and more reliable way than AppInit\_DLLs injection is using \syscall{SetWindowsHookEx} function of the Windows API. It requires no special privileges and can be set to only hook into a specific application or even being system wide. There are several events available that can be registered for. The DLL to be injected is loaded inside the current process to locate the address of the callback function. A handle to the loaded module and the just retrieved address are then passed as parameters to the \syscall{SetWindowsHookEx} function. An example is shown in appendix \ref{appendix:setwindowshookex}. The DLL will not get loaded into the remote process until the registered hook is called for the first time. Once the hook is called, a additional thread can be started to make the injection independent of hook callback function. As this module and especially any created thread are running the context of the remote process, the DLL code has now full access on the process virtual memory. Direct memory manipulation can now be performed which will get explained in detail in the next section. As well as for AppInit\_DLLs injection, chrome doesn't prevent \syscall{SetWindowsHookEx} DLL injections.