\section{Implementation of Detection Algorithm}
Most injection techniques call at some point in time the two important OpenProcess and WriteProcessMemory functions to inject into or modify in the remote process. It is not possible to easily intercept these calls from inside a usermode process. One might try to prevent this function call and successful injecting from happening by just limitting the process access rights and removing the required permissions to call virtual memory modifying functions like WriteProcessMemory and ReadProcessMemory. The OpenProcess function will then not be able to return a handle with the required permissions. Implementing this approach works great in a test-application seen in [INSERT REF HERE], however once added to google chrome, chrome malfunctions. Chrome relies heavily on interprocess communication and therefore WriteProcessMemory and ReadProcessMemory are heavily used. Compiling chromium with the shown DACL Deny code results in a running executable that is at the end not fully functioning. The content of the browser is not displayed and opening webpages fails and immediatly returns to the current open about:blank page. Therefore a different approach has to be taken to limit virtual memory modification.

The newly created problem with the modified DACL can be solved by creating a driver running in kernelmode. As reading memory, checking files and running processes are a common problem when writing anti virus software, microsoft introduced object manager routines since Windows Vista to provide an efficient way of reacting onto these events. A driver would then use the ObRegisterCallbacks function to get notified whenever processes are created, files are opened and images (DLLs and EXEs) are loaded. This functionality offers the programmer to create a pre and post-execution callback function. Microsoft offers an example driver using ObRegisterCallbacks at [INSERT REF HERE] and shows how to modifiy the requested process handle permissions. In the provided example, the process will - as long as it is protected by the driver - not be terminated from outside. To protect chrome the same actions described earlier will now be taken from inside the driver. Newly created process handles will be restricted to non virtual memory modifying permissions and the existing problem with interprocess communication can be resolved by not restricting chromes child processes explicitly and give them a full access handle. [INSERT REF HERE] shows an implemente driver to fullfill the requirments. 